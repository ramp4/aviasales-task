(this["webpackJsonpaviasales-task"]=this["webpackJsonpaviasales-task"]||[]).push([[0],{19:function(e,t,n){},23:function(e,t,n){e.exports=n.p+"static/media/logo.0c089234.svg"},24:function(e,t,n){e.exports=n(40)},33:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a,c=n(0),r=n.n(c),o=n(7),s=n.n(o),i=n(6),l=n(3),p=n(1);n(4);!function(e){e.GET_TICKETS_REQUEST="GET_TICKETS_REQUEST",e.GET_TICKETS_SUCCESS="GET_TICKETS_SUCCESS",e.GET_TICKETS_FAIL="GET_TICKETS_FAIL",e.SORT_BY_SOME="SORT_BY_SOME"}(a||(a={}));var u,m={ticketsList:[],isFetching:!1,isFailed:!1,cheap:!0},f=function(e,t){if("fast"===t){!1;var n=document.querySelector("#cheap");null===n||void 0===n||n.classList.toggle("selected")}else{!0;var a=document.querySelector("#fast");null===a||void 0===a||a.classList.toggle("selected")}};!function(e){e.SET_FILTER_OPTION="SET_FILTER_OPTION"}(u||(u={}));var h={filterOptions:{all:!0,non_stop:!0,one_stop:!0,two_stop:!0,three_stop:!0}},d=Object(l.c)({filter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.SET_FILTER_OPTION:var n=t.payload.filterOptions,a=function(){n=Object.entries(n).every((function(e,t){return 0===t||(!0===e[1]||void 0)}))?{all:!0,non_stop:!0,one_stop:!0,two_stop:!0,three_stop:!0}:Object(p.a)({},n,{all:!1})};switch(+t.payload.clickedIndex){case 0:n=Object.entries(t.payload.filterOptions).every((function(e,t){return!0===e[1]}))?{all:!1,non_stop:!1,one_stop:!1,two_stop:!1,three_stop:!1}:{all:!0,non_stop:!0,one_stop:!0,two_stop:!0,three_stop:!0};break;case 1:n=Object(p.a)({},n,{non_stop:!n.non_stop}),a();break;case 2:n=Object(p.a)({},n,{one_stop:!n.one_stop}),a();break;case 3:n=Object(p.a)({},n,{two_stop:!n.two_stop}),a();break;case 4:n=Object(p.a)({},n,{three_stop:!n.three_stop}),a();break;default:n={all:!0,non_stop:!0,one_stop:!0,two_stop:!0,three_stop:!0}}return Object(p.a)({},e,{filterOptions:n,clickedIndex:t.payload.clickedIndex});default:return e}},tickets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.GET_TICKETS_REQUEST:return Object(p.a)({},e,{isFetching:!0});case a.GET_TICKETS_SUCCESS:return Object(p.a)({},e,{ticketsList:t.payload,isFetching:!1});case a.GET_TICKETS_FAIL:return Object(p.a)({},e,{isFailed:!0,isFetching:!1});case a.SORT_BY_SOME:var n=e.cheap,c=t.payload.some,r=document.querySelector("#".concat(c));return null===r||void 0===r||r.classList.toggle("selected"),f(n,c),Object(p.a)({},e,{cheap:!n});default:return e}}}),_=n(21),E=n.n(_),g=n(22),v=Object(l.d)(d,Object(l.a)(g.a,E.a));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(33);var T=n(8),O=n(9),k=n(11),b=n(10),S=n(12),y=(n(19),n(16)),j=n.n(y),C=function(e){function t(e,t,a){var c=j()(e),r=j()(e).add(t,"minutes"),o=n(c),s=n(r);if(a){var i=0,l=0,p=+o.slice(0,2),u=+s.slice(0,2),m=0,f=+o.slice(3,5);return(m=+s.slice(3,5)-f)<0&&(m+=60,l-=1),m>60&&(m-=60,l+=1),(l=u-p+l)>23&&(l-=24),l<0&&(l+=24),i=(i=Math.floor(t/1440))>0?"".concat(i,"\u0434"):"",m<10&&(m="0".concat(m)),"".concat(i," ").concat(l,"\u0447 ").concat(m,"\u043c")}return"".concat(o," - ").concat(s)}var n=function(e){var t=+e.format("mm");(t=5*Math.floor(t/5))<10&&(t="0".concat(t));var n=e.format("HH");return"".concat(n,":").concat(t)};return c.createElement("div",{className:"ticket"},c.createElement("p",{className:"ticket__price"},"".concat(e.price," \u0420")),c.createElement("img",{className:"ticket__carrier",src:"http://pics.avs.io/440/144/".concat(e.carrier,".png"),alt:e.carrier}),e.segments.map((function(n,a){return c.createElement("div",{key:a,className:"segment"},c.createElement("p",{className:"flight"},c.createElement("span",{className:"flight__title title"},"".concat(e.segments[a].origin," - ").concat(e.segments[a].destination)),c.createElement("br",null),c.createElement("span",{className:"flight__info info"},t(e.segments[a].date,e.segments[a].duration,!1))),c.createElement("p",{className:"duration"},c.createElement("span",{className:"duration__title title "},"\u0412 \u041f\u0423\u0422\u0418 "),c.createElement("br",null),c.createElement("span",{className:"duration__info info"},t(e.segments[a].date,e.segments[a].duration,!0))),c.createElement("p",{className:"stops"},c.createElement("span",{className:"stops__title title"},function(e){var t;return t=0===e?"\u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a":1===e?"\u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430":"\u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438","".concat(e," ").concat(t)}(e.segments[a].stops.length)),c.createElement("br",null),c.createElement("span",{className:"stops__info info"},e.segments[a].stops.join(", "))))})))},I=function(e){var t=function(){var t=e.options,c=e.ticketsList,r=Object.entries(t).map((function(e,t){if(!0===e[1])return 0!==t?t-1:null})),o=[];return c.forEach((function(e,t){for(var n=!1,a=0;a<2;++a)for(var c=0;c<r.length;++c)e.segments[a].stops.length===r[c]&&(n=!0);n&&o.push(e)})),function t(c){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.length-1;if(!e.cheap)return c.length>1&&(r=a(c,o,s),o<r-1&&t(c,o,r-1),r<s&&t(c,r,s)),c;c.length>1&&(r=n(c,o,s),o<r-1&&t(c,o,r-1),r<s&&t(c,r,s))}(o),o};function n(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length-1,a=e[Math.floor((n+t)/2)].price,c=t,r=n;c<=r;){for(;e[c].price<a;)c++;for(;e[r].price>a;)r--;if(c<=r){var o=[e[r],e[c]];e[c]=o[0],e[r]=o[1],c++,r--}}return c}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length-1;function a(t){return(e[t].segments[0].duration+e[t].segments[1].duration)/2}for(var c=(e[Math.floor((n+t)/2)].segments[0].duration+e[Math.floor((n+t)/2)].segments[1].duration)/2,r=t,o=n;r<=o;){for(;a(r)<c;)r++;for(;a(o)>c;)o--;if(r<=o){var s=[e[o],e[r]];e[r]=s[0],e[o]=s[1],r++,o--}}return r}return c.createElement("div",{className:"tickets-template"},function(){var n,a=t();return 0!==a.length?n=a.map((function(e,t){return c.createElement(C,{key:t,segments:e.segments,price:e.price,carrier:e.carrier})})):0!==e.ticketsList.length&&(n=c.createElement("p",null,"\u0411\u0438\u043b\u0435\u0442\u043e\u0432 \u0441 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e")),n}())},N=(n(35),n(36),function(e){return c.createElement("button",{className:"tab ".concat(e.classType),id:e.id,onClick:e.onClickHandler},e.innerText)}),x=function(e){function t(e){var n;return Object(T.a)(this,t),(n=Object(k.a)(this,Object(b.a)(t).call(this,e))).handleTabClick=function(e){var t=e.currentTarget.id;e.preventDefault(),n.props.sortBySome(t)},n.props.getTickets(),n}return Object(S.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this;return c.createElement("main",{className:"main"},c.createElement("div",{className:"tabs"},c.createElement(N,{onClickHandler:this.handleTabClick,id:"cheap",key:"cheap",innerText:"\u0421\u0410\u041c\u042b\u0419 \u0414\u0415\u0428\u0415\u0412\u042b\u0419",classType:"selected"}),c.createElement(N,{onClickHandler:this.handleTabClick,id:"fast",key:"fast",innerText:"\u0421\u0410\u041c\u042b\u0419 \u0411\u042b\u0421\u0422\u0420\u042b\u0419",classType:"deselected"})),function(){var t;return e.props.isFetching?t=c.createElement("p",null,"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u044e..."):e.props.isFailed&&(t=c.createElement("p",null,"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435")),t}(),c.createElement(I,{ticketsList:this.props.ticketsList,cheap:this.props.cheap,options:this.props.filterOptions}))}}]),t}(c.Component),F=Object(i.b)((function(e){return{ticketsList:e.tickets.ticketsList,filterOptions:e.filter.filterOptions,isFetching:e.tickets.isFetching,isFailed:e.tickets.isFailed,cheap:e.tickets.cheap}}),(function(e){return{sortBySome:function(t){return e({type:a.SORT_BY_SOME,payload:{some:t}})},getTickets:function(){return e({type:a.GET_TICKETS_REQUEST}),fetch("https://front-test.beta.aviasales.ru/search").then((function(e){return e.json()})).then((function(e){return e.searchId})).then((function(t){fetch("https://front-test.beta.aviasales.ru/tickets?searchId=".concat(t)).then((function(e){return e.json()})).then((function(t){var n=t.tickets;return e({type:a.GET_TICKETS_SUCCESS,payload:n}),n})).catch((function(t){e({type:a.GET_TICKETS_FAIL})}))}))}}}))(x),w=(n(37),function(e){return c.createElement("div",{className:"".concat(e.name," filter_option")},c.createElement("input",{id:e.id,className:"".concat(e.name,"__option filter_checkbox checkbox"),type:"checkbox",name:"".concat(e.name,"__option"),value:e.name,onChange:e.onChange,checked:e.checked}),c.createElement("label",{htmlFor:e.id,className:"control-checkbox control"},e.text))}),L=[{name:"all",text:"\u0412\u0441\u0435"},{name:"non_stop",text:"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"},{name:"one_stop",text:"1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430"},{name:"two_stop",text:"2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"},{name:"three_stop",text:"3 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"}],G=(n(38),Object(i.b)((function(e){return{filterOptions:e.filter.filterOptions}}),(function(e){return{setOptions:function(t,n){return e({type:u.SET_FILTER_OPTION,payload:{filterOptions:t,clickedIndex:n}})}}}))((function(e){var t=function(t){var n=t.currentTarget.id;e.setOptions(e.filterOptions,n)};return c.createElement("aside",{className:"filter"},c.createElement("h3",{className:"filter_title"},"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"),Object.entries(e.filterOptions).map((function(e,n){return c.createElement(w,{id:""+n,key:n,name:L[n].name,text:L[n].text,onChange:t,checked:!0===e[1]})})))}))),K=(n(39),n(23)),R=n.n(K),M=function(e){function t(){return Object(T.a)(this,t),Object(k.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(S.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("img",{className:"App_logo",alt:"App_logo",src:R.a}),r.a.createElement(G,null),r.a.createElement(F,null))}}]),t}(r.a.Component);s.a.render(r.a.createElement(i.a,{store:v},r.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[24,1,2]]]);
//# sourceMappingURL=main.8b4c201d.chunk.js.map